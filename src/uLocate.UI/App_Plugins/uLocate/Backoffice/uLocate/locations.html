<div data-ng-controller="uLocate.Controllers.LocationsController">
    <umb-panel class="uLocate">
        <umb-header>
            <div class="span7">
                <h1>Locations</h1>
            </div>
            <div class="span5">
                <div class="btn-toolbar pull-right umb-btn-toolbar">
                    <div class="btn-group">
                        <!-- TODO: Clicking should add .open to the .btn-group parent div, which will display the dropdown -->
                        <a class="btn">Actions <span class="caret"></span></a>
                        <!-- TODO: In umbraco, this is generated using umb-options-menu, which you can see an example of in Umbraco.Web.UI.Client\build\belle\views\content\edit.html. The actions allowed for this menu item are determined in the uLocate TreeController -->
                        <ul class="dropdown-menu umb-actions">
                            <!-- ngRepeat: action in actions -->
                            <li class="action">
                                <a><i class="icon icon-add"></i><span class="menu-label">Create</span></a> <!-- TODO: Opens the page to create a new location -->
                            </li>
                            <li class="action sep">
                                <a><i class="icon icon-refresh"></i><span class="menu-label">Reload nodes</span></a> <!-- TODO: Reloads the locations and ideally kicks the cache in the teeth -->
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </umb-header>

        <div class="umb-panel-body">

            <div class="umb-pane">

                <div class="map-wrapper span12">
                    <div class="map-bar top row-fluid">
                        <!-- Search -->
                        <form class="span8 form-search">
                            <i class="icon-search"></i>
                            <input type="text" placeholder="Search uLocate addresses" class="span9" ng-modoel="filter" />
                            <a class="btn btn-primary" ng-click="changeFilter(filter)">Search</a>
                        </form>
                        <div class="span4">
                            <div class="btn-group pull-right">
                                <a class="btn btn-primary">Create</a> <!-- TODO: Opens the page to create a new location -->
                            </div>
                        </div>
                    </div>
                    <div class="map" id="location-map"></div>
                    <div class="map-bar bottom row-fluid">
                        <!-- perPage dropdown -->
                        <div class="span6 form-inline" ng-show="locationsLoaded">
                            <label class="control-label">Show:</label>
                            <select class="input-small" ng-model="selected.perPage" ng-options="option for option in options.perPage" ng-change="updatePerPage(selected.perPage)"></select>
                        </div>
                        <!-- Pagination -->
                        <div class="span6 text-right" ng-show="hasLocations()">
                            <button type="button" class="btn btn-link" ng-click="changePage(-1)" ng-show="page > 0"><i class="icon-left-double-arrow"></i></button>
                            <span>{{page + 1}} / {{totalPages}}</span>
                            <button type="button" class="btn btn-link" ng-click="changePage(1)" ng-show="page < (totalPages - 1)"><i class="icon-right-double-arrow"></i></button>
                        </div>
                    </div>
                </div>
                <!-- Locations -->
                <table class="table table-hover sortable" ng-show="hasLocations()">
                    <thead>
                        <tr>
                            <!-- TODO: Should be able to sort by name, address, phone, lat/long, and type -->
                            <th><input type="checkbox" /></th> <!-- TODO: The only bulk action that should be available is delete. See Janae about the best way to do this? -->
                            <th>Name</th>
                            <th>Address</th>
                            <th>Phone</th>
                            <th>Lat/Long</th>
                            <th>Type</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="location in locations" class="vcard" ng-click="zoomToLocation(location)">
                            <!-- TODO: When clicking on the row of an address, it zooms in on the pin -->
                            <td><input type="checkbox" /></td>
                            <td class="fn"><a href class="link-blue" ng-click="openViewDialog(location)">Mindfly</a></td>
                            <td class="adr">
                                <span class="street-address">{{location.address.address1}}</span>
                                <span class="extended-address" ng-show="location.address.address2 != ''">{{location.address.address2}}</span>
                                <span class="locality">{{location.address.locality}}</span>, <span class="region">{{location.address.region}}</span> <span class="postal-code">{{location.address.postalCode}}</span>
                                <span class="country-name">{{location.address.countryName}}</span>
                            </td>
                            <td class="tel" ng-show="location.phone != ''">{{location.phone}}</td>
                            <td class="geo">
                                <span class="latitude">{{location.coordinates.latitude}}</span> / <span class="longitude">{{location.coordinates.longitude}}</span>
                            </td>
                            <td>{{location.type}}</td>
                            <td class="btn-group text-right">
                                <a class="btn btn-mini" ng-click="openEditDialog(location)"><i class="icon-edit"></i></a>
                                <a class="btn btn-mini btn-danger"><i class="icon-trash"></i></a> <!-- TODO: Should have a delete confirmation; we should check how Umbraco does it - I think it's a generic alert -->
                            </td>
                        </tr>
                    </tbody>
                </table>

            </div>

        </div>

    </umb-panel>
</div>